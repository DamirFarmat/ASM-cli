# ASM - –ú–æ–¥—É–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Å—Å–∏–≤–Ω–æ–π —Ä–∞–∑–≤–µ–¥–∫–∏

–ú–æ–¥—É–ª—å–Ω–æ–µ CLI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–∞—Å—Å–∏–≤–Ω–æ–π —Ä–∞–∑–≤–µ–¥–∫–∏ –¥–æ–º–µ–Ω–æ–≤ –∏ IP-–∞–¥—Ä–µ—Å–æ–≤: DNS/Email health, –≤–µ–±‚Äë—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–≤ —Ç.—á. Wappalyzer Next), –ø—Ä–æ–≤–µ—Ä–∫–∞ security‚Äë–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, —Å–µ—Ç–µ–≤–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞, TLS/SSL.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîç DNS-–∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ MXToolbox API
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Email Health –∏ Domain Health
- –ê–Ω–∞–ª–∏–∑ SPF, DMARC, DKIM –∑–∞–ø–∏—Å–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MXToolbox API

### üõ†Ô∏è –†—É—á–Ω–æ–π DNS-–∞–Ω–∞–ª–∏–∑
- –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö API
- –ê–Ω–∞–ª–∏–∑ NS-—Å–µ—Ä–≤–µ—Ä–æ–≤, SOA-–∑–∞–ø–∏—Å–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ DNS-–∑–æ–Ω—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è SPF, DMARC, DKIM

### üåê –í–µ–±‚Äë–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
- `--web-version`: –∞–Ω–∞–ª–∏–∑ –≤–µ–±‚Äë—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π —á–µ—Ä–µ–∑ python‚ÄëWappalyzer (—Å–∫–∞–Ω–∏—Ä—É–µ—Ç http/https, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã)
- `--web-test`: –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ Wappalyzer Next (CLI + –±—Ä–∞—É–∑–µ—Ä–Ω–∞—è —ç–º—É–ª—è—Ü–∏—è) —Å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º–∏ –æ—Ç–ø–µ—á–∞—Ç–∫–∞–º–∏
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CMS, —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤, —Å–µ—Ä–≤–µ—Ä–æ–≤. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML‚Äë–æ—Ç—á–µ—Ç–æ–≤

### üõ°Ô∏è HTTP Security Headers
- `--header`: –ø—Ä–æ–≤–µ—Ä–∫–∞ security‚Äë–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (HSTS, CSP, X‚ÄëFrame‚ÄëOptions, X‚ÄëContent‚ÄëType‚ÄëOptions, Referrer‚ÄëPolicy, Permissions‚ÄëPolicy, COOP/COEP/CORP, X‚ÄëXSS‚ÄëProtection)
- –ö–æ–Ω—Å–æ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –ø–æ http/https –±–µ–∑ –¥—É–±–ª–µ–π, —Ü–≤–µ—Ç–æ–≤–æ–π HTML‚Äë–æ—Ç—á—ë—Ç (missing/warning/passed)

### üåç –°–µ—Ç–µ–≤–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ InternetDB (Shodan)
- –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Å–∏—Å—Ç–µ–º–Ω—ã–π PATH):
```bash
pipx install .
# –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–º–∞–Ω–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–∞–∫:
asm --help
```

–í–∞—Ä–∏–∞–Ω—Ç 2 (–ª–æ–∫–∞–ª—å–Ω–æ):
```bash
python -m venv .venv && . .venv/Scripts/activate  # Windows PowerShell
pip install -r requirements.txt
python asm.py --help
```

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –≤–µ–±‚Äë–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤
- `--web-version`: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç python‚ÄëWappalyzer (—Å—Ç–∞–≤–∏—Ç—Å—è –∏–∑ `requirements.txt`). –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö `pkg_resources` –æ–±–Ω–æ–≤–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
  ```bash
  python -m pip install --upgrade pip setuptools wheel
  ```
- `--web-test` (Wappalyzer Next):
  - –¢—Ä–µ–±—É–µ—Ç—Å—è Firefox –∏ geckodriver
  - –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π CLI `wappalyzer` (–ª—É—á—à–µ –≥–ª–æ–±–∞–ª—å–Ω–æ):
    ```bash
    pipx install wappalyzer
    # –ø—Ä–æ–≤–µ—Ä–∫–∞
    wappalyzer --help
    ```
  - –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `wappalyzer` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ PATH

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–µ–π
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# MXToolbox API (–¥–ª—è --dns)
MXTOOLBOX_API_KEY=–í–ê–®_–ö–õ–Æ–ß_–û–¢_MXTOOLBOX

# InternetDB –Ω–µ —Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á–∞ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å)
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ü–µ–ª–µ–π
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `targets.txt` —Å —Ü–µ–ª—è–º–∏ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):

```txt
# –î–æ–º–µ–Ω—ã –¥–ª—è DNS –∏ –≤–µ–±-–∞–Ω–∞–ª–∏–∑–∞
example.com
google.com
github.com

# IP-–∞–¥—Ä–µ—Å–∞ –¥–ª—è —Å–µ—Ç–µ–≤–æ–π —Ä–∞–∑–≤–µ–¥–∫–∏
8.8.8.8
1.1.1.1
```

### DNS-–∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ MXToolbox API

```bash
# –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
python asm.py --dns -f targets.txt

# –° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º JSON –æ—Ç–≤–µ—Ç–æ–≤
python asm.py --dns -f targets.txt --json

# –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π HTML-–æ—Ç—á–µ—Ç–∞
python asm.py --dns -f targets.txt --html
```

### –†—É—á–Ω–æ–π DNS-–∞–Ω–∞–ª–∏–∑ (–±–µ–∑ API)

```bash
# –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑ —Ñ–∞–π–ª–∞
python asm.py --dns-manual -f targets.txt

# –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ —Å –ø—Ä—è–º–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–æ–º–µ–Ω–∞
python asm.py --dns-manual example.com

# –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π HTML-–æ—Ç—á–µ—Ç–∞
python asm.py --dns-manual -f targets.txt --html
```

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å NS-—Å–µ—Ä–≤–µ—Ä–æ–≤
- –ê–≤—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å DNS-—Å–µ—Ä–≤–µ—Ä–æ–≤
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SOA-–∑–∞–ø–∏—Å–µ–π
- SPF, DMARC, DKIM –∑–∞–ø–∏—Å–∏
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ NS-—Å–µ—Ä–≤–µ—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö DNS

### –í–µ–±‚Äë–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã

```bash
# –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–∏–∑ —Ñ–∞–π–ª–∞ –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é)
python asm.py --web -f targets.txt
python asm.py --web example.com

# –¢–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π (python‚ÄëWappalyzer)
python asm.py --web-version -f targets.txt
python asm.py --web-version example.com

# –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π HTML-–æ—Ç—á–µ—Ç–æ–≤
python asm.py --web -f targets.txt --html
python asm.py --web-version -f targets.txt --html

# –ê–Ω–∞–ª–∏–∑ Wappalyzer Next (—Ç—Ä–µ–±—É–µ—Ç wappalyzer, Firefox, geckodriver)
python asm.py --web-test -f targets.txt
python asm.py --web-test example.com --html
```

### üì¶ –ê–Ω–∞–ª–∏–∑ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ EOL –ø–æ –≤–µ–±-–æ—Ç—á—ë—Ç—É

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç JSON –∏–∑ –≤–µ–±-–º–æ–¥—É–ª—è –∏ –æ–±–æ–≥–∞—â–∞–µ—Ç –µ–≥–æ –¥–∞–Ω–Ω—ã–º–∏ –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö (NVD) –∏ —Å—Ç–∞—Ç—É—Å–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/–æ–∫–æ–Ω—á–∞–Ω–∏—è –∂–∏–∑–Ω–∏ (endoflife.date).

```bash
# –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º JSON –∏ CSV
python asm.py --vuln -i reports/web_analyzer_report_YYYYMMDD_HHMMSS.json \
  --json-out reports/web_enriched.json --csv-out reports/web_enriched.csv

# –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å API –∫–ª—é—á NVD –¥–ª—è –±–û–ª—å—à–∏—Ö –ª–∏–º–∏—Ç–æ–≤
python asm.py --vuln -i reports/web_analyzer_report_*.json --nvd-api-key YOUR_KEY

# –ï—Å–ª–∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –ø—É—Ç–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã, –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–∞ –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
python asm.py --vuln -i reports/web_analyzer_report_*.json
```

–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö:
- CVE: NVD (`https://services.nvd.nist.gov/rest/json/cves/2.0`)
- EOL: `https://endoflife.date/api/<product>.json`


**–û–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- –í–µ–±-—Å–µ—Ä–≤–µ—Ä—ã (Apache, Nginx, IIS)
- CMS (WordPress, Drupal, Joomla)
- –§—Ä–µ–π–º–≤–æ—Ä–∫–∏ (Laravel, Django, Rails)
- –Ø–∑—ã–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- CDN –∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä—ã

### –°–µ—Ç–µ–≤–∞—è —Ä–∞–∑–≤–µ–¥–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤

```bash
# –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ (–∏–∑ —Ñ–∞–π–ª–∞ –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é)
python asm.py --network -f targets.txt
python asm.py --network 8.8.8.8 1.1.1.1

# –° —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º JSON –æ—Ç–≤–µ—Ç–æ–≤
python asm.py --network -f targets.txt --json

# –° –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π HTML-–æ—Ç—á–µ—Ç–∞
python asm.py --network -f targets.txt --html
```

### üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ TLS/SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–µ—Ä—Å–∏–∏ TLS (1.0/1.1/1.2/1.3) –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –∏—Å—Ç–µ–∫–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π; –æ—à–∏–±–∫–∞, –µ—Å–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω). –§–æ—Ä–º–∏—Ä—É–µ—Ç –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥, JSON –∏/–∏–ª–∏ HTML.

```bash
# –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–∏–∑ —Ñ–∞–π–ª–∞ –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é)
python asm.py --cert -f targets.txt
python asm.py --cert example.com github.com

# –° HTML –∏ JSON –æ—Ç—á—ë—Ç–∞–º–∏
python asm.py --cert -f targets.txt --html --json
```

**–ü–æ–ª—É—á–∞–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### ‚ö†Ô∏è –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- `python‚ÄëWappalyzer`: –æ—à–∏–±–∫–∞ `No module named 'pkg_resources'` ‚Äî –æ–±–Ω–æ–≤–∏—Ç–µ `setuptools` (`python -m pip install --upgrade pip setuptools wheel`)
- `wappalyzer` (Next): —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `wappalyzer` –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ PATH, –∞ —Ç–∞–∫–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã Firefox –∏ geckodriver
- –°–µ—Ç–∏/SSL: –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–∞–π—Ç—É –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∫—Å–∏/—Ñ–∞–π—Ä–≤–æ–ª

## –ó–∞–ø—É—Å–∫ –∏–∑ PATH (pipx)
–ü–æ—Å–ª–µ `pipx install .` –∫–æ–º–∞–Ω–¥–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–∞–∫ `asm` –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞:
```bash
asm --help
asm --dns -f targets.txt --html
asm --web-test example.com --html
asm --header example.com --html
```

